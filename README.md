# social_network_system_design
Домашнее задание по курсу System Design:
проектирование социальной сети для путешественников.

# Функциональные требования
- публикация постов с привязкой к месту путешествия  
Каждый пост может содержать описание до 2200 символов, включая знаки препинания и пробелы,
место путешествия, а также от 0 до 10 фотографий размером не более 5 МБ каждая.
- оценка и комментарии постов других путешественников  
Оценка представляет из себя эмоджи (палец вверх, вниз, сердечко, огонь, слезы и т.д.)  
Длина комментария не более 1500 символов.
- подписка на других путешественников
- поиск популярных мест для путешествий и просмотр постов о них  
Получение выборки постов о местах, указанных пользователями чаще всего.
- просмотр ленты других путешественников и ленты пользователя, основанной на подписках в обратном хронологическом порядке  
Просмотр ленты подписок, ленты пользователя - последние посты сверху.
- поддержка мобильных устройств и десктопного браузера  
Возможность работы на всех современных мобильных устройствах и десктопных браузерах

# Нефункциональные требования
- аудитория СНГ
- доступность 99,95%
- 10000 DAU и заложено увеличение вдвое каждый год
- пик нагрузки приходится на июнь-август 
  - множитель сезона: х5
- данные храним всегда
- активность пользователя в среднем за день  
  - пролистывает 200 постов по 20 за раз
  - оценивает 50 постов  
  - комментирует 10 постов  
  - загружает 100 комментариев по 20 за раз
  - добавляет 0,11 постов (20 постов за 6 мес)
  - добавляет 0,17 подписок (5 подписок в месяц)
  - делает поиск популярных мест 0,01 в день (1 раз в 3 мес) и пролистывает 100 постов из результатов
- лимиты
  - в системе реализовано 15 видов реакций
  - пользователь может добавлять не более 30 постов в день  
  - пользователь может добавлять не более 1000000 подписок и иметь не более 1000000 подписчиков
- тайминги  
  - создание поста 1 с  
  - добавление реакции/комментария 0,1 с  
  - добавление подписки 0,1 с  
  - поиск популярных мест 3 с  
  - получение постов пользователя 2-3 с

# Расчет нагрузки
- кол-во одновременных соединений = 10% DAU = 1000
- размеры данных  
  - пост = (id, user_id, текст, created_at, место, массив из {id, image, created_at}) = 8 + 8 + 2200 + 8 + 512 + (8 + 5120 + 8) * 10 = 54 КБ  
  - реакция  
    запись (user_id, post_id, id реакции, created_at) =  8 + 8 + 4 + 8 = 28 Б  
    чтение (id реакции, кол-во пользователей) = 8 + 8 = 16 Б
  - комментарий = (id, user_id, текст, created_at) = 8 + 8 + 1500 + 8 = 1,5 КБ  
  - подписка = (id, following_user_id, user_id, created_at) = 8 + 8 + 8 + 8 = 32 Б
- посты (запись и чтение)
  - RPS  
    write = 10000 DAU * 0,11 / 86400 = 0,01  
    read = 10000 DAU * 10 / 86400 = 1,16
  - трафик  
    write = 0,01 * 54 КБ = 0,6 КБ/с  
    read = 1,16 * 20 * (пост 54 КБ + реакции 15 * 20 Б + комментарии 20 * 1,5 КБ) = 2 МБ/с
- реакции (запись. Чтение идет вместе с постом)
  - RPS = 10000 DAU * 50 / 86400 = 0,6  
  - трафик = 0,6 * 28 Б = 17 Б/с
- комментарии (запись и чтение. Первые 20 комментариев загружаются с постом, также можно запрашивать следующие комментарии)  
  - RPS  
    write = 10000 DAU * 10 / 86400 = 1,16  
    read = 10000 DAU * 100 / 86400 = 11,6
  - трафик  
    write = 1,16 * 1,5 КБ = 1,8 КБ/с  
    read = 11,6 * 1,5 КБ = 18 КБ/с
- подписки (запись)
  - RPS = 10000 DAU * 0,17 / 86400 = 0,02  
  - трафик = 0,02 * 32 Б = 0,7 Б/с
- поиск популярных мест для путешествий (чтение)  
  загрузка 100 постов из результатов по 20 постов за раз  
  - RPS = 10000 DAU * 0,01 * 5 / 86400 = 0,006    
  - трафик = 0,006 * 20 * 54 КБ = 6,5 КБ/с